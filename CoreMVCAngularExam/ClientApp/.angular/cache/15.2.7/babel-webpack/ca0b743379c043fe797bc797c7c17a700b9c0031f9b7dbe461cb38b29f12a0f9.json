{"ast":null,"code":"import { HttpErrorResponse } from '@angular/common/http';\nimport { AddCategoryDialogComponent } from './addNewCategory.component';\nimport { EditCategoryDialogComponent } from '../edit-category-dialog/edit-category-dialog.component';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"./categorydata.service\";\nimport * as i2 from \"@angular/material/dialog\";\nimport * as i3 from \"@angular/common\";\nfunction CategoriesComponent_p_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\")(1, \"em\");\n    i0.ɵɵtext(2, \"Please, choose action.\");\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction CategoriesComponent_table_6_tr_10_button_8_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r7 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 7);\n    i0.ɵɵlistener(\"click\", function CategoriesComponent_table_6_tr_10_button_8_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r7);\n      const category_r3 = i0.ɵɵnextContext().$implicit;\n      const ctx_r5 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r5.deleteCategory(category_r3.categoryId));\n    });\n    i0.ɵɵtext(1, \" Delete \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction CategoriesComponent_table_6_tr_10_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r9 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\")(6, \"button\", 2);\n    i0.ɵɵlistener(\"click\", function CategoriesComponent_table_6_tr_10_Template_button_click_6_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r9);\n      const category_r3 = restoredCtx.$implicit;\n      const ctx_r8 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r8.updateCategory(category_r3.categoryId, category_r3.categoryName));\n    });\n    i0.ɵɵtext(7, \"Edit\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(8, CategoriesComponent_table_6_tr_10_button_8_Template, 2, 0, \"button\", 6);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const category_r3 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(category_r3.categoryId);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(category_r3.categoryName);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngIf\", category_r3.categoryId !== undefined);\n  }\n}\nfunction CategoriesComponent_table_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"table\", 4)(1, \"thead\")(2, \"tr\")(3, \"th\");\n    i0.ɵɵtext(4, \"Id\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"th\");\n    i0.ɵɵtext(6, \"Category Name\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"th\");\n    i0.ɵɵtext(8, \"Action\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(9, \"tbody\");\n    i0.ɵɵtemplate(10, CategoriesComponent_table_6_tr_10_Template, 9, 3, \"tr\", 5);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(10);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r1.categories);\n  }\n}\nexport class CategoriesComponent {\n  constructor(categoryDataSrv, dialog) {\n    this.categoryDataSrv = categoryDataSrv;\n    this.dialog = dialog;\n  }\n  ngOnInit() {\n    this.showAll();\n    /*this.categories = this.categoryDataSrv.categories;*/\n  }\n\n  showAll() {\n    this.categoryDataSrv.showAll();\n    this.categories = this.categoryDataSrv.categories;\n  }\n  addCategory() {\n    // Открываем диалоговое окно для добавления контакта\n    const dialogRef = this.dialog.open(AddCategoryDialogComponent, {\n      width: '400px'\n    });\n    dialogRef.afterClosed().subscribe(result => {\n      if (result) {\n        console.log('Данные из диалога:', result);\n        this.categoryDataSrv.addCategory(result);\n        // Дополнительные действия\n      } else {\n        console.log('Диалог закрыт без данных');\n      }\n    });\n  }\n  deleteCategory(categoryId) {\n    this.categoryDataSrv.deleteCategory(categoryId);\n  }\n  updateCategory(categoryId, categoryName) {\n    if (categoryId === undefined || !categoryName) {\n      // Отобразить сообщение об ошибке пользователю, что categoryId не определен\n      return;\n    }\n    const dialogRef = this.dialog.open(EditCategoryDialogComponent, {\n      data: {\n        categoryId,\n        categoryName\n      }\n    });\n    dialogRef.afterClosed().subscribe(result => {\n      if (result && result.categoryId && result.categoryName) {\n        this.categoryDataSrv.updateCategory(result.categoryId, result.categoryName).subscribe(response => {\n          this.showAll();\n        }, error => {\n          if (error instanceof HttpErrorResponse) {\n            if (error.error.errors && error.error.errors.CategoryName) {\n              // Отобразить сообщение об ошибке пользователю\n              // Например, используя Angular Material Snackbar\n              this.snackBar.open('Validation error: ' + error.error.errors.CategoryName[0], 'Close', {\n                duration: 5000\n              });\n            }\n          }\n        });\n      }\n    });\n  }\n}\nCategoriesComponent.ɵfac = function CategoriesComponent_Factory(t) {\n  return new (t || CategoriesComponent)(i0.ɵɵdirectiveInject(i1.CategoryDataService), i0.ɵɵdirectiveInject(i2.MatDialog));\n};\nCategoriesComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: CategoriesComponent,\n  selectors: [[\"categories\"]],\n  decls: 7,\n  vars: 2,\n  consts: [[4, \"ngIf\"], [1, \"example-button-row\"], [\"mat-button\", \"\", 1, \"btn\", \"btn-accent\", 3, \"click\"], [\"class\", \"table\", 4, \"ngIf\"], [1, \"table\"], [4, \"ngFor\", \"ngForOf\"], [\"mat-button\", \"\", \"class\", \"btn Warn\", 3, \"click\", 4, \"ngIf\"], [\"mat-button\", \"\", 1, \"btn\", \"Warn\", 3, \"click\"]],\n  template: function CategoriesComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"h1\");\n      i0.ɵɵtext(1, \"Categories\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(2, CategoriesComponent_p_2_Template, 3, 0, \"p\", 0);\n      i0.ɵɵelementStart(3, \"div\", 1)(4, \"button\", 2);\n      i0.ɵɵlistener(\"click\", function CategoriesComponent_Template_button_click_4_listener() {\n        return ctx.addCategory();\n      });\n      i0.ɵɵtext(5, \"Add Category\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵtemplate(6, CategoriesComponent_table_6_Template, 11, 1, \"table\", 3);\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"ngIf\", !ctx.categories);\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"ngIf\", ctx.categories);\n    }\n  },\n  dependencies: [i3.NgForOf, i3.NgIf],\n  styles: [\".demo-table[_ngcontent-%COMP%] {\\r\\n  width: 60%;\\r\\n}\\r\\n\\r\\n.example-button-row[_ngcontent-%COMP%]   button[_ngcontent-%COMP%], .example-button-row[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] {\\r\\n  margin-right: 8px;\\r\\n}\\r\\n\\r\\n.example-disabled[_ngcontent-%COMP%] {\\r\\n  display: inline-block;\\r\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvY2F0ZWdvcmllcy9jYXRlZ29yaWVzLmNvbXBvbmVudC5jc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDRSxVQUFVO0FBQ1o7O0FBRUE7O0VBRUUsaUJBQWlCO0FBQ25COztBQUVBO0VBQ0UscUJBQXFCO0FBQ3ZCO0FBQ0E7OztDQUdDIiwic291cmNlc0NvbnRlbnQiOlsiLmRlbW8tdGFibGUge1xyXG4gIHdpZHRoOiA2MCU7XHJcbn1cclxuXHJcbi5leGFtcGxlLWJ1dHRvbi1yb3cgYnV0dG9uLFxyXG4uZXhhbXBsZS1idXR0b24tcm93IGEge1xyXG4gIG1hcmdpbi1yaWdodDogOHB4O1xyXG59XHJcblxyXG4uZXhhbXBsZS1kaXNhYmxlZCB7XHJcbiAgZGlzcGxheTogaW5saW5lLWJsb2NrO1xyXG59XHJcbi8qLmRlbW8tYnV0dG9uICsgLmRlbW8tYnV0dG9uIHtcclxuICBtYXJnaW4tbGVmdDogOHB4O1xyXG59XHJcbiovXHJcbiJdLCJzb3VyY2VSb290IjoiIn0= */\"]\n});","map":{"version":3,"mappings":"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","names":["HttpErrorResponse","AddCategoryDialogComponent","EditCategoryDialogComponent","i0","CategoriesComponent","constructor","categoryDataSrv","dialog","ngOnInit","showAll","categories","addCategory","dialogRef","open","width","afterClosed","subscribe","result","console","log","deleteCategory","categoryId","updateCategory","categoryName","undefined","data","response","error","errors","CategoryName","snackBar","duration","selectors","decls","vars","consts","template","ctx"],"sourceRoot":"","sources":["F:\\STEP\\My_Project\\Angular\\CoreMvcAngularExam\\CoreMVCAngularExam\\ClientApp\\src\\app\\categories\\categories.component.ts","F:\\STEP\\My_Project\\Angular\\CoreMvcAngularExam\\CoreMVCAngularExam\\ClientApp\\src\\app\\categories\\categories.component.html"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\r\nimport { MatDialog } from '@angular/material/dialog';\r\nimport { CategoryDataService, Category } from './categorydata.service';\r\nimport { HttpClient, HttpErrorResponse } from '@angular/common/http';\r\nimport { AddCategoryDialogComponent } from './addNewCategory.component';\r\nimport { EditCategoryDialogComponent } from '../edit-category-dialog/edit-category-dialog.component';\r\n\r\n@Component({\r\n  selector: 'categories', \r\n  templateUrl: './categories.component.html',\r\n  styleUrls: ['./categories.component.css'],\r\n})\r\n\r\nexport class CategoriesComponent implements OnInit {\r\n  public categories: Category[] | undefined;\r\n    http: any;\r\n    snackBar: any;\r\n\r\n  constructor(private categoryDataSrv: CategoryDataService, private dialog: MatDialog) {\r\n    }\r\n    \r\n  ngOnInit() {\r\n    this.showAll();\r\n      /*this.categories = this.categoryDataSrv.categories;*/\r\n    }\r\n    \r\n    showAll() {\r\n      this.categoryDataSrv.showAll();\r\n      this.categories = this.categoryDataSrv.categories;\r\n    }\r\n\r\n  addCategory() {\r\n    // Открываем диалоговое окно для добавления контакта\r\n    const dialogRef = this.dialog.open(AddCategoryDialogComponent, {\r\n      width: '400px',\r\n    });\r\n\r\n    dialogRef.afterClosed().subscribe(result => {\r\n      if (result) {\r\n        console.log('Данные из диалога:', result);\r\n        this.categoryDataSrv.addCategory(result);\r\n        // Дополнительные действия\r\n      } else {\r\n        console.log('Диалог закрыт без данных');\r\n      }\r\n    });\r\n  }\r\n\r\n  deleteCategory(categoryId: number): void {\r\n\r\n    this.categoryDataSrv.deleteCategory(categoryId);\r\n  }\r\n\r\n  updateCategory(categoryId: number | undefined, categoryName: string | undefined): void {\r\n    if (categoryId === undefined || !categoryName) {\r\n      // Отобразить сообщение об ошибке пользователю, что categoryId не определен\r\n      return;\r\n    }\r\n\r\n    const dialogRef = this.dialog.open(EditCategoryDialogComponent, {\r\n      data: { categoryId, categoryName }\r\n    });\r\n\r\n    dialogRef.afterClosed().subscribe(result => {\r\n      if (result && result.categoryId && result.categoryName) {\r\n        this.categoryDataSrv.updateCategory(result.categoryId, result.categoryName)\r\n          .subscribe(\r\n            response => {\r\n              this.showAll();\r\n            },\r\n            error => {\r\n\r\n              if (error instanceof HttpErrorResponse) {\r\n\r\n                if (error.error.errors && error.error.errors.CategoryName) {\r\n\r\n                  // Отобразить сообщение об ошибке пользователю\r\n                  // Например, используя Angular Material Snackbar\r\n                  this.snackBar.open('Validation error: ' + error.error.errors.CategoryName[0], 'Close', {\r\n                    duration: 5000,\r\n                  });\r\n                }\r\n              }\r\n            }\r\n          );\r\n      }\r\n    });\r\n  }\r\n  \r\n}\r\n","<h1>Categories</h1>\r\n\r\n<!--<p>This component demonstrates fetching data from the server.</p>-->\r\n\r\n<p *ngIf=\"!categories\"><em>Please, choose action.</em></p>\r\n<div class=\"example-button-row\">\r\n  <button mat-button (click)=\"addCategory()\" class=\"btn btn-accent\">Add Category</button>\r\n</div>\r\n<table class='table' *ngIf=\"categories\">\r\n  <thead>\r\n    <tr>\r\n      <th>Id</th>\r\n      <th>Category Name</th>\r\n      <th>Action</th>\r\n    </tr>\r\n  </thead>\r\n  <tbody>\r\n    <tr *ngFor=\"let category of categories\">\r\n      <td>{{ category.categoryId }}</td>\r\n      <td>{{ category.categoryName }}</td>\r\n      <td>\r\n        <!-- categories.component.html -->\r\n        <button mat-button\r\n                (click)=\"updateCategory(category.categoryId, category.categoryName)\"\r\n                class=\"btn btn-accent\">Edit</button>\r\n\r\n        <button mat-button *ngIf=\"category.categoryId !== undefined\"\r\n                (click)=\"deleteCategory(category.categoryId)\" class=\"btn Warn\">\r\n          Delete\r\n        </button>\r\n      </td>\r\n    </tr>\r\n\r\n  </tbody>\r\n</table>\r\n\r\n\r\n\r\n\r\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}